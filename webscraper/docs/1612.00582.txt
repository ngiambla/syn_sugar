7
1
0
2

 

y
a
M
1
1

 

 
 
]

Y
C
.
s
c
[
 
 

2
v
2
8
5
0
0

.

2
1
6
1
:
v
i
X
r
a

PredictingChangesinAffectiveStatesusingNeuralNetworksStinaLyckCarstensen,JensMadsenandJanLarsenTechnicalUniversityofDenmarkDepartmentofAppliedMathematicsandComputerScienceRichardPetersensPlads,Building3242800KongensLyngby,Denmark{stlc,jenma,janla}@dtu.dkAbstractKnowledgeofpatientsaffectivestatecouldprovetobecrucialforhealth-careprofessionalsinbothdiagnosisandtreatment,however,thisrequirespatientstoreporthowtheyfeel.Inpracticethesamplingrateofaffectivestatesneedstobekeptlow,inordertoensurethatthepatientscanrest.Furthermoreusingtraditionalmethodsofmeasuringaffectivestates,isnotalwayspossible,e.g.patientscanbeincapableofverbalcommunications.Inthisstudyweexplorethepredictionofpeoplesself-reportedaffectivestatebymeasuringmultiplephysiologicalsignals.WeusedifferentNeuralnetworks(NN)setupsandcomparewithdifferentmultiplelinearregression(MLR)setupsforpredictionofchangesinaffectivestates.TheresultsshowedthatNNandMLRpredictedthechangeinaffectivestateswithaccuraciesof91.88%and89.10%,respectively.1IntroductionPhysiologicalmonitoringsystemsathospitalsaremoreandmoreoftenusedastoolsfordiagnosingandtreatmentofpatients.Signalsrecordedusingsuchsystemscontaininformationaboutthepatient’physiologicalstate,butmightalsocontaininformationaboutthepatient’psychologicalwell-being.Anaffectivestateisapsychologicalconstructdeﬁningemotionsandmood[1],andishenceonewayofrepresentingapsychologicalstates[1].Russell’scircumplexmodelcanbeusedtodescribeaffectivestates[2].Thismodelspansaffectinatwodimensionalspace,byusingthevalenceandactivationaxes[3].Ifaffectivestatescanbepredictedfromphysiologicalsignals,itwouldbepossibletomakecontinuouslymeasurementsofpatients’affectivestates.Suchpredictionwouldbeofgreathelpforhealth-careprofessionalswhentreatingaswellasdiagnosingpatients.Measurementsofaffectivestatesarecurrentlyperformed,byaskingpeoplehowtheyfeel,usingagreatvarietyofself-reportmethods[1].Self-reportmethodsareverydependentonthesubjectsunderstandingofthemethod,aswellasthescaleandvocabularyused.Furthermorewhenaquestionisrepeatedlyasked,toobtaine.g.affectivestates,peopletendtodrift,whichinturninducesabias[4,5,6].Thebiascanbecausedbyanchoringandadjustment,thatispeopleignoretheirabsolutepositionintheaffectivespace,andinsteadadjusttheiranswerrelativetopreviousanswer(theanchor)[4,5,6].Activationofthesympatheticnervoussysteminﬂuencesmanyphysiologicalmeasures,suchasHeartRate(HR),HeartRateVariability(HRV)andElectroDermalActivity(EDA).Thesemeasuresareassociatedwithaffectivestates[7],andareoftenavailableinclinicalsettings,makingthemidealforpredictivemodeling.Inpreviousstudieswhereaffectivestateshavebeenpredictedfromphysiologicalsignals,amultitudeofdifferentfeatureshavebeentested[8,9].InthesestudiesfeaturessuchasHR,ElectroDermalRe-30thConferenceonNeuralInformationProcessingSystems(NIPS2016),Barcelona,Spain.sponse(EDR),andSkinConductanceLevel(SCL)wereextractedtopredicttheperceivedactivationusinglinearmodels.Howeverthesemodelsfailedatpredictingthedimensionofvalence.In[9]theywereabletopredictvalencewithupto89.75%accuracy(subjectdependent)usingnon-linearneuralnetworks(NN).Otherstudieshaveusedothermodalitiessuchasfacialexpressions,speechfeatures[10],self-reportsofactivity[11]etc.Howevermostofthesemethodswerenotdesignedtobeusedinclinicalsettings,mainlyduetopracticalissues,e.g.facialexpressionsaredifﬁculttoacquireandpatientscouldbeincapableofverbalcommunication.Furthermore,theseapproachesconcentrateonmodelingtheindividualmakingthemsubjectdependentmodelsandthereforerarelyapplicableinclinicalsettings[9].1.1GoalofcurrentstudyThegoalofthisstudyistotaketheﬁrststeptowardsmakingsubjectindependentpredictionsofchangesinaffectivestatesthatcanbeusedinclinicalsettings.Previousstudieshavefoundthatthevalencedimensionisbestmodeledbynon-linearmodels[9,12].Comparisonsofnon-linearmodelshaveshownthatespeciallynon-linearNNsareveryeffectiveforpredictingsubject-dependentlevelsofvalence,aswellasactivation,fromphysiologicalsignals[13,14].Wethereforeusenon-linearNNstopredictchangesinsubjects’affectivestate,usingsubject-independentmodels,andcomparethesepredictionswithpredictionsfromlinearsubject-independentmodels.Weusephysiologicalsignals,whichareoftenavailableinclinicalsettings,andhencenoextraequipmentformonitoringe.g.facialexpressionorspeechsignalsisneeded.Basedontheanchoringtheory,andincontrasttopreviousstudies[8,9,10,11,15],wemodelthechangesinaffectivestatesinsteadofpredictingeachannotationindependently.Wethusrelievetheanchoringbiasmakingmodelingmorerobust.Finally,wewillinvestigatehowperformanceisinﬂuencedbythemodelparametersandfeaturesused.2Methods2.1ExperimentalprocedureWedesignalaboratoryexperimentwiththreedifferentexperimentalconditions.Theconditionsaredesignedtoensurechangesintheexperiencedaffectivestates.Theyincluded:abaseline-,astressor-,andamusicstimuluscondition.Thepurposeofthebaselineconditionistomakesubjectsrelax,thestressorconditionisdesignedtoincreasetheperceivedlevelofactivation,bygivingthesubjectsastress-fulltask.Sincemusicinducesagreatvarietyofemotionalresponses[16]itisanappropriatestimulitomakesubjectscovertheaffectivespace.32subjectsparticipatedintheexperiment(17women,15men).Thesubjectsarenotinformedaboutthepurposeoftheexperiment,apriory.DuringeachconditiontheEDAandtheblood-volumebymeansofphotoplethysmography(PPG)arerecorded.Thefeaturesextractedfromthephysiologicalsignalsinclude:SCLandEDRfromEDAaswellasHR,andHRVfromPPG.Tomakephysiologicalfeaturescomparableacrosssubjects,eachsubjectsfeature-setisstandardized.Aftereachoftheconditionsthesubjectsareaskedtoplaceamarkerintheaffectivespace,whichrepresentstheiraffectivestates.However,afterthelasttwoconditions,themarkertheyplacedinthepreviousconditionisalsoshown,andtheyarenowaskedtoplacetheirmarkerrelativetohowtheyfeltbefore.Inthiswayweareabletocontrolwhatanchorsubjects’usefortheiraffectivestates,andusethisknowledgetoreducetheanchoringbias.2.2ModelsTopredictchangesinperceivedvalenceandactivation,fromthephysiologicalfeatures,weuseNN.TheLevenberg-Marquardtmethodisusedforparameterestimation[17].Toexplorethemostoptimalsolution,differentNN-modelsetupsaretestedincluding:1)Allpossiblefeaturecombinations;2)Varyingthenumberofhiddenlayersandhiddenunitsfrom1to4and1to12,respectively,and3)varyingtheamountoftemporaldata.Wetestthemodelsusingthefeaturesextractedinawindow20secondsbeforetheanswerisgivenandupto280secondsbeforetheanswerisgiven,usingastep-sizeof20seconds.Thehyperbolictan-sigmoidfunctionisusedastransfer-functioninhiddenlayers[18],theoutputlayerusesalinearfunction.Inaddition,MultipleLinearRegressions(MLR)wasperformed,toseeifsimplelinearrelationexistedbetweenthephysiologicalsignalsandthechangeinvalenceandactivation.22.3PerformanceevaluationAhold-one-subject-outcross-validationschemeisused,resultinginsubjectindependentmodels.Eachsubjectreportedtheiraffectivestatethreetimes,thatisafterthebaseline,stressorandmusiccondition,resultingintwotest-samplesforeachmodel.FortheNN,alltrainingandtestingsetupsarerepeated10timestoensurethattheﬁnalresultswouldberepresentativeforthemodelsetup.ThepredictionsoftheNNandMLRarecomparedagainst3differentbenchmarkpredictions:1)predictingtheaverageofthevalenceandactivationannotationsinthetrainingset,2)randomvaluesdrawnfromauniformdistributionrangingoverthepossibletarget-valuesand3)randomvaluesdrawnfromanormaldistributionwithmean0andastandarddeviationof6.Tocomparetheperformanceofthebenchmarksandthemodels,theaverageerrorforthepredictionsforallsubjectswascalculatedfortheNNandtheMLR.Theaccuracywascalculatedastheratiobetweentheerrorandthemaximumpossibleerror.3ResultsInFigure1atheanswersgivenafterthethreeconditionsareshown.Theﬁgureshowsthatalargeareaoftheaffectivespaceisused.Figure1bshowsthechangebetweenconditions,thesearethetargetvaluesusedforpredictions.(a)(b)Figure1:InFigure(a)theanswersgivenafterbaseline(blue),stressor(red)andmusic(yellow)areshown.Figure(b)showschangesfrombaselinetostressor(blue)andfromstressortomusic(red)thesearethetargetvaluesfortheneuralnetworkandmultiplelinearregressions.TheexperimentwasperformedinDanish,andthelabelsontheaxisarehencetranslatedfromDanishtoEnglish.ThebestaverageaccuracyofpredictingthevalenceandactivationwastheNN,achievinganaccuracyof91.88%.ThisnetworkusedthefeaturesEDR,HR,andHRVextractedin260secondsofphysiologicaldata,using3layerseachwith11hiddenunits.ThebestperformingMLRmodelusedtheEDRandSCLextractedin260secondwindows,whichresultedinanaccuracyof89.10%.TheaccuracyofbestperformingNNandMLRwascomparedusingaone-wayANOVA,furthermoretheTukey-Kramermethodwasusedascorrectionformultiplecomparison,andthesigniﬁcancelevelwassettoα=0.05.Thecomparisonofthepredictionsfromthetwomodels,showsthattheNNisnotsigniﬁcantlybetterthantheMLRmodelforpredictingactivation(p=0.68)andvalence(p=0.14).InFigure2AtheaccuracyofthebestperformingNNandMLRmodelsasafunctionofthetemporaldatausedforfeatureextractionisshown.Theﬁgurealsoshowstheaccuracyofthebenchmarkpredictions.Theaccuracyofthebenchmarkpredictionwhenusingtheaveragewere88.35%and71.27%,randomvaluesfromuniformdistributionwere71.35%and69.28%,andrandomvaluesfromanormaldistributionwere84.90%and71.84%forvalenceandactivationrespectively.ThemultiplecomparisonanalysisshowedthatbothMLRandNNweresigniﬁcantlybetteratpredictingthechangeinactivationcomparedwithanyofthebenchmarks.ForthevalencepredictionstheperformanceoftheNNweresigniﬁcantlybetterthananyofthebenchmarks,whiletheMLRwereonlysigniﬁcantlybetterthanthetworandompredictions.3Figure2:(A)showtheaccuraciesasafunctionofthetimeincludedtomaketheprediction,(B)showstheaccuraciesasafunctionofthethenumberofunitsineachlayer.InFigure2BtheaccuracyoftheNNmodels’predictions(using260secondswindowstoextracttheEDR,HR,andHRV)isshownforthedifferentnumberofhiddenunits,foreachofthenumberofhiddenlayers.Table1showstheaccuracyofthebestperformingNNandMLRmodelsforthedifferentfeature-sets.Table1:ThetableshowstheaccuracyofthebestperformingNNandMLRforeachfeature-set,thebestpredictionsforvalenceandactivationareboldfacedActivationValenceActivationValenceActivationValencefeature-setNNMLRNNMLRfeature-setNNMLRNNMLRfeature-setNNMLRNNMLREDR90.4688.8691.9588.95HR86.5585.3990.3386.19SCL86.8086.5392.4584.24HRV81.6180.2889.8880.41EDR,SCL89.3488.9092.2089.40EDR,HR90.0988.6792.3789.23EDRHRV91.2588.5992.2188.75SCLHR90.3586.7192.0486.89SCLHRV90.0486.7992.1084.22HRHRV86.8085.1891.3386.14EDRSCL90.4588.6292.4189.47EDRSCL90.9988.7892.4889.30HRHRVSCLHR90.4186.4492.7486.75EDR,HR,91.3588.5392.4389.40EDRSCL90.5988.4192.6489.07HRVHRVHRHRV4DiscussionandconclusionThepurposeofthestudywastoexamineifchangesinaffectivestatescouldbepredicted,subjectindependently,usingphysiologicalfeatures.Thehighestachievedaccuracywas92.74%and91.35%whenpredictingchangesinvalenceandactivation,respectively.BothMLRandNNmodels,per-formedsigniﬁcantlybetterthantheformulatedbenchmarksintheactivationdimension.Nosigniﬁcantdifferencebetweenthetwomodelswerefoundintheactivationorinthevalencedimension.ButtheNN-modelvalencepredictionsweresigniﬁcantlybetterthanallthebenchmarks,whilethiswasnotthecasefortheMLRmodel.UsinglongertemporalwindowswhencomputingfeaturesincreasedtheaccuracyofthepredictedchangesinactivationforbothMLRandNN,andthevalencefortheMLRmodel.Thiscouldsuggeststhatsubjectsbasetheirself-reportedannotationsonhowtheyarehavebeenfeelingoveralongerperiodoftime,orthatthereisadelaybetweenphysiologicaltopsychologicalresponsestostimuli.Inconclusion,itwasfoundthatpredictingchangesinaffectivestatesfromphysiologicalsignalsispossible,whereonlytheNNoutperformedthebenchmarksinbothdimensions.5FutureworkThepresentstudyusedaspeciﬁc,baseline-stressor-musicsequenceofconditionsinordertocovertheentireaffectivespace.Togeneralizeoutsidethiskindoflaboratoryconditionsfurtherexperimentationisneeded,toensurethemodelisuniversal.Inclinicalenvironments,peopletendtohaveabnormalphysiologicalsignals.Usingamodeltrainedonhealthypatients,whoarecapableofcommunicating,inacontrolledlaboratoryexperiment,wouldnotnecessarilybethebestmodelinaclinicalsettings.Hence,toconﬁrmthatcontinuouslymonitoringofaffectivestatesonpatients,indifferentconditions,ispossible,clinicalstudiesshouldbeperformed.Wehaveshownthatthechangeinaffectivestatecanbepredicted,howeveritshouldbenotedthatthepositionintheaffectivespacecannotbedeterminedbasedontheseprediction.Thismeansthatitisonlypossibletotellifapersonismoreoflesspleasedoractivatedthanbefore,butnotingeneraliftheyarepleasedorfeelsactivated.Futurestudiesshouldhencetrytoincludepredictionsofchangesrelativetoplaceintheaffectivespace.4AcknowledgmentsAuthorsweresupportedinpartbytheInnovationFundDenmarkthroughtheCoSoundproject,casenumber0603-00475B.Thispublicationonlyreﬂectstheauthors’views.References[1]PanteleimonEkkekakis.TheMeasurementofAffect,Mood,andEmotionAGuideforHealth-BehavioralResearch.CambridgeUniversityPress,2013.[2]JamesA.Russel.Acircumplexmodelofaffect.Journalofpersonalityandsocialpsychology,39(6):1161–1178,1980.[3]JamesARussell.Affectgrid:Asingle-itemscaleofpleasureandarousal.Journalofpersonalityandsocialpsychology,57(3):493–502,1989.[4]HunterGehlbachandScottBarge.Anchoringandadjustinginquestionnaireresponses.BasicandAppliedSocialPsychology,34:417–433,2012.[5]GretchenB.ChapmanandBrainBornstein.Themoreyouaskfor,themoreyouget:Anchoringinpersonalinjuryverdicts.Appliedcognitivepsychology,10:519–540,1996.[6]BradleyJ.Adame.Traininginthemitigationofanchoringbias:Atestoftheconsider-the-oppositestrategy.LearningandMotivation,53:36–48,2016.[7]ChristianPeter,EricEbert,andHelmutBeikirch.AffectiveInformationProcessing,chapterPhysiologicalSensingforAffectiveComputing.Springer,2009.[8]KonstantinosTrochidisandSimonLui.Music,MindandEmbodiment,chapterModelingAffectiveResponsestoMusicUsingAudioSignalAnalysisandPhysiology.Springer,2016.[9]FrankA.Russo,NareshH.Vempala,andGillianM.Sanstrom.Predicitingmusicallyinducedemotionsfromphsyoloigcalinputs:linearandneuralnetworkmodels.Frontiersinpsychology,4,2013.Article468.[10]BjörnSchuller.Advancesinneuralnetworkcomputationalandtheoreticalissues,chapterDeepLearningOurEverydayEmotions.AShortOverview.Springer,2015.[11]ZackZhu,HectorF.Satizábal,UlfBlanke,AndresPerez-Uribe,andGerhardTröster.Naturalis-ticrecognitionofactivitiesandmoodusingwearableelectronics.IEEETransactiononaffectivecomputing,7:272–285,2016.[12]AndreasHaag,SilkeGoronzy,PeterSchaich,andJasonWilliams.EmotionRecognitionUsingBio-sensors:FirstStepstowardsanAutomaticSystem,pages36–48.SpringerBerlinHeidelberg,2004.[13]GaetanoValenza,AntonioLanata,andEnzoPasqualeScilingo.Theroleofnonlineardynamicsinaffectivevalenceandarousalrecognition.IEEETransactiononAffectiveComputing,3,2012.[14]S.Jerritta,MMurugappan,andKhairunizamWanRNagarajanand.Physiologicalsignalsbasedhumanemotionrecognition:Areview.IEEE7thInternationalColloquiumonSignalProcessinganditsApplications,2011.[15]TuomasEerola.Modelinglisteners’emotionalresponsetomusic.TopicsinCognitiveScience,4:607–624,2012.[16]SwathiSwaminathanandE.GlennSchellenberg.Currentemotionresearchinmusicpsychology.Emotionreview,7(2):189–197,2014.[17]K.Madsen,H.B.Nielsen,andO.Tingleff.Methodsfornon-linearleastsquaresproblems.InformaticsandMathematicalModellingTechnicalUniversityofDenmark,2,2004.http://www2.imm.dtu.dk/pubdb/views/edoc_download.php/3215/pdf/imm3215.pdf.[18]ChristopherM.Bishop.PatternRecognitionandMachineLearning,chapter5:NeuralNetworks.Springer,2006.5