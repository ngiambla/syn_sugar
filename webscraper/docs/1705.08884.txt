7
1
0
2

 

y
a
M
4
2

 

 
 
]

Y
C
.
s
c
[
 
 

1
v
4
8
8
8
0

.

5
0
7
1
:
v
i
X
r
a

Uncovering the Flop of the EU Cookie Law

Martino Trevisan† Stefano Traverso† ⋆ Hassan Metwalley† ⋆ Marco Mellia† ⋆

†Politecnico di Torino ⋆Ermes Cyber Security SRL

{first.last}@polito.it

Abstract

In 2002, the European Union (EU) introduced the ePrivacy Directive
to regulate the usage of online tracking technologies. Its aim is to make
tracking mechanisms explicit while increasing privacy awareness in users.
It mandates websites to ask for explicit consent before using any kind of
proﬁling methodology, e.g., cookies. Starting from 2013 the Directive is
mandatory, and now most of European websites embed a “Cookie Bar”
to explicitly ask user’s consent.

To the best of our knowledge, no study focused in checking whether
a website respects the Directive. For this, we engineer CookieCheck, a
simple tool that makes this check automatic. We use it to run a measure-
ment campaign on more than 35, 000 websites. Results depict a dramatic
picture: 65 % of websites do not respect the Directive and install tracking
cookies before the user is even oﬀered the accept button.

In few words, we testify the failure of the ePrivacy Directive. Among
motivations, we identify the absence of rules enabling systematic auditing
procedures, the lack of tools to verify its implementation by the deputed
agencies, and the technical diﬃculties of webmasters in implementing it.

1 Introduction

When browsing the web, users encounter the so-called “trackers”. They build
their business on the massive collection and brokerage of personal data, and
severely threaten users’ privacy [16, 25]. To regulate the usage of tracking
technologies in the web, the EU Commission published in 2002 the ePrivacy
Directive, popularly known as the “Cookie Law”. It is one of the most strict
regulations on the usage of online tracking mechanisms [6, 7, 8]. Article 5
requires websites to ask “prior informed consent for storage or for access to
information stored on a user’s terminal equipment”. In other words, a website
must ask the visitor if she authorizes the usage of cookies and similar tracking
mechanisms (e.g., web beacons, Flash cookies, etc.) before delivering and in-
stalling them. Each EU member state has adopted the Directive starting from
2013. Since then, its eﬀect has become evident to end users because of the
presence of a “Cookie Bar” on most of websites (even if outside EU).

1

Despite the Directive has been in force for more than three years, there is
no study reporting how it is actually implemented and to what extent. In fact,
to the best of our knowledge, there exists no tool to automatically check if a
website respects the Directive.
In this paper, we present CookieCheck [1], a
simple tool we engineer to automatically perform this check. Given a website,
CookieCheck visits it as a “new user”, and analyses cookies installed on the
client browser. If any of them is classiﬁed as proﬁling, CookieCheck tags the
website as not compliant with the Directive.

We use CookieCheck for a large measurement campaign involving websites
from 25 countries and 25 categories. Results are discouraging: The large ma-
jority (65%) of European websites violates the ePrivacy Directive, with some
categories (e.g., “News and Media”) where violations top to 92%. Funnily, Adult
sites come second in respecting it, after Law and Government sites.

Since each EU state has adopted a custom version of the ePrivacy Directive,
we further check if users from countries with strictest (e.g., Italy) or not up-to-
date (e.g., Germany) regulations get diﬀerent protection from online tracking.
Results show marginal changes. In a similar way, changing browser, or consid-
ering mobile/desktop devices has little impact on results. In short, the ePrivacy
Directive is regularly violated.

The Directive has been criticized as a case of regulatory failure: it impairs
user browsing experience, and it is ineﬀective in increasing the awareness about
online tracking [17, 20, 24, 12]. Here, we show that the Directive is a failure from
the enforcement perspective too. As possible causes, we identify the fact that
the Directive deputizes each member state to monitor its enforcement without
sketching standardized auditing procedures, as well as the technical diﬃculties
for webmasters at monitoring the activity of third parties embedded in websites
(see Sec. 7 for a thorough discussion).

We strongly believe our results can be useful for both researchers and poli-
cymakers in the debate on how to regulate and enforce privacy policies on the
web.

2 Background

In this section we ﬁrst describe the cookie technology in the context of online
tracking. Then, we describe the regulatory frameworks available in diﬀerent
countries to govern the usage of cookies.

2.1 Cookies as tracking technology

Web services use cookies to store user information directly in the browsers. Each
time the browser sends a request to a server, it can attach a cookie installed dur-
ing previous communications, so that the status of the transaction is preserved
over time.

When loading a web page the user’s browser generally contacts diﬀerent
servers to fetch all page objects. Some of these are ﬁrst-party, i.e., belonging

2

to the same domain of the website, and some are third-party, i.e., belonging
to diﬀerent domains, e.g., Content Delivery Networks (CDN), advertisement
platforms, etc. Cookies are installed on a per-domain basis. Therefore, ﬁrst-
party cookies can be installed by the website (the ﬁrst party), whereas third-party
cookies can be installed by third-party servers.

Cookies expiration time makes them also diﬀerent. Session cookies are tem-
porary, i.e., deleted when the user closes the browser or after a short period of
time. Persistent cookies contain an explicit expiration date and stay stored in
the browser for long periods of time.

Third-party persistent cookies are the most prominent means used by trackers
to reconstruct users’ browsing trajectories and compute per-user proﬁles which
are employed to, e.g., deliver personalized advertisement [14]. As these threaten
users’ privacy, policymakers undertook initiatives to regulate their usage.

In this paper we focus on cookies installed by trackers, that we refer as
proﬁling cookies. Our approach can be extended to more advanced tracking
techniques such as beacons, ﬂash cookies, canvas, etc.

2.2 Regulatory frameworks for web privacy

There exists no comprehensive regulatory framework concerning web privacy,
and each country eventually provides its own – see [21] for an exhaustive com-
parison.

Some countries, e.g., Brazil, China and US, lack of a regulation concerning
users’ web privacy. Other countries, e.g., Australia, India and Russia, devel-
oped regulatory frameworks that are vague with no technical details. The most
comprehensive frameworks which aim at regulating personal data collection and
usage in the web are those provided by Canada, Switzerland and the EU. In
this paper we focus on the latter, being its framework the most prominent, and
involving a large number of countries.

The EU introduced the Data Protection Directive [6] in 1995. It provided a
deﬁnition for “personal data”, and delineated criteria of transparency, legitimate
purpose and proportionality.
It did not address web tracking, since, at that
time, the web was at its birth. The Directive has been amended in 2002 [7]
and 2009 [8]. In the last version, it explicitly disciplines the use of any tracking
“devices” (e.g., cookies, supercookies, ﬁngerprinting, etc.), and it is based on
the “explicit consent” principle.
It states that the website must i) provide a
clear description of the entities wishing to install tracking devices, ii) install
them only after explicit consent is provided by the user, and iii) describe how
the gathered information will be used.

Opinion 04/2012 [11] explicitly considers cookies, and clariﬁes which kinds
are exempted from the requirement of explicit consent: session cookies, and
cookies that are essential to provide the service are exempted (e.g., to handle
a cart in an e-commerce website). Prior consent is required for all others. The
document explicitly observes that third-party persistent cookies are typically not
essential and, thus, not exempted. This is the case of proﬁling cookies. Opinion
15/2011 [10] details the consent procedure, and mandates the websites to i) oﬀer

3

the user a short resume of the privacy policy, ii) a link to page containing all
details, and iii) an interactive element to explicitly ask users’ consent to install
tracking devices. All this information is typically provided in a “Accept Cookie
Bar” oﬀered the user the ﬁrst time she visits the website.

All EU member states must transpose, and likely adapt, EU Directives into
their regulatory body. As such, EU countries has transposed the ePrivacy Direc-
tive in diﬀerent ways. For instance, France and Italy fully adopted the ePrivacy
Directive, so that French and Italian websites must require user explicit consent
for cookies, except for those exempted.
In Italy, websites not respecting the
ePrivacy Directive can be ﬁned up to 120, 000 Euro. Diﬀerently, Germany has
not yet transposed the ePrivacy Directive to its regulatory body, with the result
that German websites can simply describe the privacy policy adopted, but they
are not subject to any ﬁne for not asking explicit consent.

The ePrivacy Directive does not sketch procedures to guide the enforcement

of its principles, nor provides guidelines to perform proper audits.

3 Measurement Approach

Our analysis builds on automatic browsing of web pages. For this task, we
use two diﬀerent tools: CookieCheck [1], a custom tool we engineer to provide
experiment parallelization, and WebPageTest [4] which enables higher conﬁg-
urability. Both take as input a set of web pages, and use a regular browser to
visit each. When the page is fully loaded (i.e., the OnLoad event is triggered)
or a 90s timeout elapses, they dump to ﬁle the HTTP Archive (HAR) [23], a
JSON-formatted structure that summarizes navigation data, and reports statis-
tics about services and exchanged objects. For each HTTP transaction, the
HAR logs the headers of the corresponding request/response. If not otherwise
speciﬁed, we take care of erasing the browser cache before each visit. No user
action is performed on the page. Hence, we emulate the behavior of a new user
accessing the web page for the ﬁrst time, and not providing any consent to the
installation of tracking devices such as cookies.

To understand which web pages violate the ePrivacy Directive, we analyze
the installed cookies at the end of each visit. We ﬁrst pick all HTTP responses
with Set-Cookie header.1 Next, we match the domain of the service installing
the cookie against a list of 1, 232 well-known web-tracker domains, that we
obtain from Better Privacy Tool [5]. Thus, we consider only proﬁling cookies,
i.e., third-party persistent cookies installed by trackers. For this, we pick those
having a lifetime greater than a 1 month (details about threshold setting are
provided in Sec. 5.1).

At the end of this process, we tag web pages violating the ePrivacy Directive
as those installing at least one proﬁling cookie, i.e., (i) related to a web-tracking
service, and (ii) persistent. Our approach is conservative as it builds on sub-
set of well-known tracking services, and does not include, e.g., advertisements

1The Set-Cookie header contains the cookie the server generates to install on the browser.

4

platforms, CDNs, etc. Second, we focus only on cookies leaving out all other
tracking mechanisms.

4 Tools and measurement campaigns

We run two measurement campaigns. The ﬁrst aims at checking the presence
of proﬁling cookies at scale. The second investigates how tracking cookies diﬀer
depending on device, browser settings, country, and when consent has been
given.

To perform these campaigns, we proﬁt from a Linux machine equipped with
an Intel R(cid:13) Xeon CPU with 12 cores and 32GB RAM and connected to the
Internet through a 1Gb/s network. For the analysis of data we use a medium-
size Hadoop cluster running Apache Spark and Python, whose Cookie module
allows us to parse cookies.

4.1 Large scale measurement campaign

We rely on SimilarWeb [3], a web-site ranking service analogue to Alexa to
obtain per-country and per-category website ranks. We pick popular websites
in 21 EU member states, plus 4 extra-EU countries for a more comprehensive
comparison.2 We consider sites from 25 diﬀerent categories. The list of countries
and categories can be deduced from Fig.2. For each country and category, we
pick the 100 most popular websites.
In total, we consider 25 × 25 services,
corresponding to 36, 197 unique websites to visit as the lists partially overlap.
Performing measurements on such a wide number of websites is challenging
on several points. In particular, measurements must scale and be fast enough to
visit websites in a reasonably short amount of time, without sacriﬁcing accuracy.
Hence, we build a custom web measurement tool, namely CookieCheck, based on
Google Chrome; its code can be downloaded at [2], and a working demonstrator
of the tool is available online [1]. CookieCheck runs in a Docker container that
provides a reliable and lightweight means to isolate multiple browser instances.
24 Docker containers run in parallel to speed up the visiting cycles. We repeat
each visit 5 times. In total we performed 180, 985 visits over a period of 15 days,
and collected HAR ﬁles, corresponding to 213 GB of raw data. Less than 5% of
visits failed for timeout intervention, likely due to temporarily oﬄine websites
or slow loading speed. In the remainder of the paper we refer to this dataset
with Large-DS.3

4.2 Speciﬁc measurement campaigns

We launch additional measurement campaigns using a diﬀerent web measure-
ment tool, WebPageTest from Google [4]. This tool oﬀers a more ﬂexible con-
ﬁguration than CookieCheck, but it does not enable parallel testing, thus con-

2SimilarWeb provides per-country ranks for 21 EU member states out of 28.
3Given its size, we share this dataset on demand.

5

siderably increasing the collection time. Hence, we employ WebPageTest to run
experiments on smaller sets of web pages. In particular, we focus on the the
100 most popular websites for France, Germany and Italy. In total we count
241 unique websites. We then visit each of them, changing the conﬁguration of
the tool and mimicking diﬀerent scenarios.

First, we evaluate the impact of providing consent to the installation of cook-
ies. To this end, we visit the homepage of each website in our list, and manually
give the consent to the usage of cookies whenever the Cookie Bar is present.
We save the resulting browsing proﬁle, and visit the websites again using Web-
PageTest. This lets us verify whether websites actually install proﬁling cookies
only upon user consent is provided. We refer to this dataset as CookieOK-DS.
Second, we investigate whether the use of diﬀerent browsers may aﬀect the
number of installed cookies. For instance, mobile devices typically download
simpler pages with less objects. We run tests using all browsers available within
WebPageTest: Internet Explorer, Mozilla Firefox and Google Chrome. Thanks
to Google Chrome advanced features, we emulate mobile browsers by changing
both User-Agent and screen size; we consider an Android smartphone and
tablet of the Nexus series, and an Apple iPhone6 and iPad2. We call this
dataset Browser-DS.

Finally, we study if and how websites change behavior when accessed from
diﬀerent countries. To comply with diﬀerent local regulations, a website could
react diﬀerently and install diﬀerent sets of cookies depending on the client
location (e.g, checking its IP address or language settings). To validate this
hypothesis we use HTTP-proxies to change the client IP address and the location
of the the client. For this experiment, we follow the same approach employed
in [19]. We use 8 proxies located in 8 diﬀerent European countries, changing the
locale settings accordingly. In this case we use the desktop version of Google
Chrome. We refer to this dataset as Country-DS.

5 Results

Here, we ﬁrst analyze cookie lifetime to deﬁne threshold for classifying proﬁling
cookies. Then we unveil their usage in Large-DS. Finally, we study the eﬀect
on proﬁling cookies when providing consent, and changing browser or country.

5.1 Distinguishing proﬁling cookies

As described in Sec. 3, we consider as proﬁling a cookie installed by a tracking
service and exhibiting a lifetime larger than a given threshold. A similar ap-
proach was used by the authors of [14]. To deﬁne such threshold, we compute
the cumulative distribution of third-party persistent cookie lifetimes in Large-
DS. Fig. 1 shows results. It clearly shows typical values, e.g., 1 day, 1 month,
1 year, and up to 10 years. As shown, 80% of third-party cookies last 1 month
or more. By manually inspecting them, we observe they belong mostly to web
trackers and advertising services. Hence, to conservatively deﬁne proﬁling cook-

6

1.0
0.8
0.6
0.4
0.2
0.0

F
D
C

10 s

1 h

1 d

1 m 1 y 10 y

Lifetime

Figure 1: Empirical distribution calculated over lifetimes of third-party cookies
in Large-DS.

ies, we consider all cookies installed by well-known tracking services (as by the
Better Privacy Tool), whose expiration period is 1 month or higher.

5.2 Assessing ePrivacy Directive violations at scale

We leverage CookieCheck to uncover the usage of proﬁling cookies across web
pages for each country and category. For this, we use Fig. 2, where each cell
reports the fraction of websites whereby the server installed at least one proﬁling
cookie during any of the 5 visits. We remind that 100 websites are considered
for each cell. Each row refers to a country, and each column to a category.
At the end of each row we report the country-wise average fraction. Columns
report the category-wise average fraction for EU countries only, and are sorted
from the highest violator to the lowest.

Several observations hold. First, we notice that there exists no category
whose fraction is close to 0. On average 66% of websites violates the ePrivacy
Directive. Recalling that our measurement is a conservative estimation (we
neglect tracking mechanisms diﬀerent from cookies), this fraction is startling.
Even the category with the lowest fraction of non-compliant websites – “Law and
Government” – shows 31% of websites that are not complaint with the Directive.
This is possibly due to the fact that these websites usually do not embed a
lot of advertisement since they do not build their business by selling online
ads. Yet, third-party persistent cookies are installed – possibly for analytics
services. Funnily, Adult websites come second in being the more respectful
of the Directive. They likely oﬀer little (or specializes) ads, thus hosts fewer
trackers. On the opposite side, websites in “News and Media” are totally prone
to violate the ePrivacy Directive (92% of violations on average). This is no
surprise as these websites typically hosts a lot of advertisers, and thus trackers.
If we consider per-country results, we observe that the picture is rather uni-
form, especially for EU member states. Values span from 60% (Slovakia) to 74%
(UK). Interestingly, the former has not yet transposed the ePrivacy Directive
to its regulation, while the latter did. Looking outside Europe, websites tend

7

A rts and E ntertain m ent
H o m e and G arden
N ews and  M edia

Travel

G a m es

Sports

C o m puter and Electronics
B ooks and Literature
B eauty and Fitness
A utos and V ehicles
People and Society
F ood and D rink
G a m bling
R eference
Shopping
H ealth

Finance

R ecreation and H obbies
B usiness and Industry
C areer and E ducation
Internet and T eleco m
Pets and A nim als

La w and G overn m ent

Science

A dult

1.00

s
e
i
k
o
o
c
 
g
n

i
l
i
f
o
r
p
 
g
n

i
l
l
a
t
s
n
i
 
s
e
t
i
s
b
e
w

 
f
o
 
n
o
i
t
c
a
r
F

0.84

0.68

0.52

0.36

0.20

Austria
Belgium
Bulgaria
Croatia
Czech Republic
Denmark
Finland
France
Germany
Greece
Hungary
Ireland
Italy
Netherlands
Poland
Portugal
Romania
Slovakia
Spain
Sweden
United Kingdom

Australia
Brazil
Russia
USA

0.63
0.90
0.65
0.89
0.63
0.92
0.61
0.88
0.61
0.85
0.64
0.96
0.64
0.93
0.70
0.94
0.65
0.92
0.66
0.90
0.63
0.95
0.69
0.95
0.66
0.89
0.62
0.77
0.67
0.92
0.67
0.91
0.68
0.94
0.60
0.93
0.69
0.98
0.65
0.95
0.74
0.94
0.50
0.92 0.80 0.78 0.78 0.78 0.77 0.76 0.76 0.74 0.72 0.70 0.66 0.66 0.65 0.64 0.60 0.59 0.58 0.58 0.56 0.55 0.55 0.47 0.43 0.31 0.65
0.50
˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙˙
0.50
0.50
0.74
0.94
0.69
0.97
0.86
0.95
0.75
0.94

0.68
0.69
0.51
0.69
0.59
0.73
0.67
0.63
0.75
0.64
0.63
0.71
0.67
0.70
0.59
0.68
0.76
0.61
0.65
0.64
0.64
0.50
0.50
0.67
0.69
0.89
0.68

0.76
0.73
0.75
0.68
0.76
0.80
0.80
0.82
0.82
0.78
0.72
0.75
0.74
0.66
0.81
0.71
0.70
0.75
0.74
0.77
0.85
0.50
0.50
0.85
0.84
0.91
0.88

0.80
0.84
0.78
0.68
0.82
0.71
0.78
0.93
0.78
0.87
0.80
0.81
0.75
0.72
0.91
0.79
0.80
0.81
0.82
0.73
0.82
0.50
0.50
0.82
0.90
0.90
0.85

0.80
0.85
0.74
0.81
0.70
0.81
0.79
0.83
0.79
0.74
0.74
0.79
0.74
0.79
0.75
0.73
0.70
0.73
0.79
0.79
0.79
0.50
0.50
0.81
0.78
0.86
0.79

0.64
0.66
0.69
0.67
0.47
0.65
0.67
0.66
0.70
0.68
0.66
0.69
0.66
0.67
0.58
0.74
0.69
0.56
0.71
0.63
0.70
0.50
0.50
0.74
0.66
0.82
0.70

0.57
0.63
0.58
0.55
0.58
0.59
0.61
0.59
0.55
0.59
0.58
0.58
0.61
0.49
0.64
0.54
0.53
0.57
0.59
0.53
0.63
0.50
0.50
0.53
0.54
0.80
0.61

0.33
0.37
0.48
0.35
0.44
0.49
0.52
0.54
0.39
0.44
0.41
0.64
0.39
0.47
0.46
0.52
0.55
0.43
0.43
0.48
0.68
0.50
0.50
0.67
0.66
0.89
0.55

0.81
0.73
0.61
0.65
0.66
0.79
0.71
0.86
0.86
0.67
0.75
0.79
0.85
0.73
0.79
0.80
0.75
0.67
0.83
0.77
0.86
0.50
0.50
0.93
0.83
0.89
0.89

0.72
0.72
0.73
0.76
0.70
0.71
0.71
0.77
0.69
0.77
0.75
0.80
0.75
0.70
0.82
0.78
0.74
0.71
0.78
0.71
0.79
0.50
0.50
0.81
0.82
0.84
0.84

0.80
0.79
0.76
0.60
0.70
0.77
0.79
0.86
0.89
0.71
0.74
0.85
0.80
0.78
0.79
0.75
0.80
0.69
0.86
0.77
0.91
0.50
0.50
0.87
0.75
0.92
0.86

0.76
0.74
0.66
0.74
0.47
0.70
0.68
0.79
0.76
0.64
0.62
0.73
0.69
0.68
0.62
0.73
0.75
0.58
0.69
0.76
0.87
0.50
0.50
0.84
0.72
0.87
0.86

0.71
0.78
0.74
0.66
0.68
0.67
0.66
0.78
0.70
0.73
0.63
0.72
0.79
0.68
0.77
0.77
0.79
0.66
0.80
0.68
0.77
0.50
0.50
0.88
0.78
0.93
0.87

0.76
0.74
0.78
0.77
0.67
0.82
0.72
0.81
0.79
0.81
0.74
0.89
0.85
0.72
0.82
0.75
0.79
0.66
0.83
0.80
0.87
0.50
0.50
0.90
0.79
0.86
0.89

0.67
0.76
0.72
0.80
0.79
0.85
0.79
0.77
0.69
0.77
0.77
0.84
0.73
0.70
0.79
0.75
0.84
0.77
0.83
0.81
0.87
0.50
0.50
0.80
0.67
0.91
0.87

0.49
0.57
0.60
0.48
0.47
0.56
0.53
0.52
0.45
0.51
0.52
0.61
0.52
0.58
0.61
0.68
0.66
0.49
0.57
0.54
0.67
0.50
0.50
0.69
0.70
0.85
0.72

0.48
0.48
0.57
0.53
0.61
0.53
0.49
0.63
0.55
0.50
0.47
0.59
0.49
0.54
0.52
0.63
0.53
0.47
0.67
0.54
0.75
0.50
0.50
0.71
0.55
0.85
0.82

0.44
0.39
0.44
0.41
0.43
0.41
0.37
0.41
0.50
0.48
0.44
0.40
0.47
0.42
0.46
0.49
0.47
0.43
0.50
0.37
0.40
0.50
0.50
0.41
0.50
0.53
0.35

0.28
0.36
0.28
0.34
0.26
0.28
0.32
0.59
0.26
0.30
0.24
0.29
0.30
0.29
0.24
0.33
0.44
0.24
0.38
0.24
0.34
0.50
0.50
0.19
0.26
0.79
0.31

0.59
0.69
0.73
0.62
0.61
0.59
0.62
0.72
0.63
0.66
0.62
0.72
0.71
0.59
0.65
0.73
0.61
0.57
0.74
0.66
0.69
0.50
0.50
0.76
0.75
0.95
0.79

0.69
0.62
0.58
0.63
0.65
0.62
0.63
0.68
0.59
0.69
0.64
0.58
0.69
0.62
0.66
0.65
0.74
0.58
0.71
0.62
0.68
0.50
0.50
0.62
0.62
0.76
0.66

0.53
0.59
0.52
0.54
0.44
0.41
0.37
0.63
0.65
0.50
0.60
0.69
0.61
0.53
0.54
0.62
0.58
0.45
0.64
0.51
0.75
0.50
0.50
0.71
0.69
0.86
0.87

0.51
0.49
0.63
0.51
0.60
0.47
0.51
0.57
0.55
0.82
0.66
0.62
0.62
0.54
0.68
0.68
0.70
0.55
0.65
0.65
0.68
0.50
0.50
0.74
0.72
0.93
0.69

0.44
0.63
0.51
0.47
0.61
0.62
0.65
0.58
0.42
0.59
0.53
0.69
0.57
0.60
0.62
0.54
0.59
0.62
0.57
0.72
0.85
0.50
0.50
0.86
0.51
0.84
0.88

0.55
0.59
0.54
0.46
0.64
0.56
0.62
0.59
0.51
0.64
0.66
0.58
0.57
0.55
0.62
0.51
0.58
0.52
0.59
0.60
0.65
0.50
0.50
0.68
0.65
0.90
0.67

Figure 2: Per-country and per-category fractions of websites installing at least
one proﬁling cookie in Large-DS. At the end of each row (column) it is reported
the country-(category)wise average.

to install more proﬁling cookies at the ﬁrst visit, with Russian (86%) and US
(75%) websites being negative examples. This demonstrates the ePrivacy Direc-
tive is having some positive eﬀect if compared to countries with no regulatory
frameworks. However, this eﬀect is small and far to be suﬃcient.

To complement above results, we double check which trackers install cookies
on users’ browser without consent. Fig. 3 reports the pervasiveness of the most
prominent trackers that install cookies before getting user’s consent: Doubleclick
from Google is the most present (appearing in 12% of websites), followed by
Adnxs by AppNexus (in 11% of websites). The popularity of the trackers clearly
inﬂuences the probability of ﬁnding it.

In conclusion, there exist diﬀerences across website categories and coun-
tries, but a clear trend strongly emerges: 65% of European websites ignore the
ePrivacy Directive and let trackers install proﬁling cookies without any prior
consent.

5.3

Installed cookies upon consent

Websites that properly respect the Directive ask for consent by means of a
button embedded in a Cookie Bar. When clicked, the website refreshes (or
updates) the page to deliver new and enriched content with objects that trigger
the installation of cookies.

We count the websites which implement this procedure, and thus do not
violate the ePrivacy Directive. We consider three countries, as reported in
Tab. 1. Surprisingly, we observe that 54% of websites in CookieOK-DS do not
even provide a Cookie Bar, but regularly set tracking cookies! In France and

8

]

%

[
 
s
e
t
i
s
 
b
e
W

 15
 10
 5
 0

g

o

o

i
b
.
a

g
le
a

m

a

c

p

is.

d

n

x

g

o

s

y

m

n

.
g
.
d

c.
a

a

t

c

o

g

o

u

d

a

b

p

d

s.c
s.
g
.
d

o

m

le.c

p
i
x

s

y

s

e

n

el.r

c.

m

h
.
a

u

b

b

.s
c

c

u

r

e

o

a

t

p

u

h

b

d

s

r

v

ic
o

t

a

p

m

g
s.

r

e

c

b
l
u

.
d

e

a

r

e

k

d

p

o

b

.rfi

d

r.

h

m

s.s

e

r

r

t

u

d

x
.
b
i
d

.t

s
-
u
.
o

s

u

m

.
a

d

d

p
i
x

t

a

a

d

d

g
.c
o

s.
g
.
d

m

o
j
e

r

e

a

i.c

s

e

o

a

r

c

o

u

h

m

x
.
n

e

t

m

m

u

b

.c
o

d

e

o

o

v
i
n

b

e

k

m

w

p

e

t

h

n

it
c

g
-
s

ie
1
.c
o

y

o

g

u

h
.
n
l.c

e

t

s.c

x
.
n

e

t

m

o

o

m

m

q

el.
is.c

u

a

n

t

s

o

m

e

r

v

e.c

o

m

t

le
clic

v
.
a

o

m

r.
o

n

p

r

r

g

d

v

k
.
n

e

r

e

t

tisi

n

o

u

b

le
clic

k
.
n

e

t

c

t.c

o

m

g
.c
o

m

b

.c
le
o
clic

m

k
.
n

e

t

Figure 3: Pervasiveness of Top–20 veriﬁed trackers. Eleven are contained in
more than 5% of web sites.

Consent
No Consent

g
n
i
l
i
f
o
r
P

s
e
i
k
o
o
C

 140
 120
 100
 80
 60
 40
 20
 0

 0

 50

 150

 100
Web Sites

 200

Figure 4: Per-website number of proﬁling cookies installed before and after
giving consent.

Italy, 69 and 53 out of 100 websites embed a Cookie Bar, respectively. For
Germany, which has yet to transpose the Directive, only 31 websites do that.
Furthermore, the Cookie Bar consent button triggers a page refresh in only 14
cases for Italian websites, just in 2 cases for French, and in no cases for German.
We consider the same 241 website to count the number of proﬁling cookies
which are installed before and after we provide consent. We report results in
Fig. 4, where websites are sorted by the number of proﬁling cookies installed
before consent (green line). To this baseline we then sum new cookies installed
after consent has been given (red dots). As shown, only 43 websites do not
install proﬁling cookies before obtaining consent. All other websites, i.e., 80.5%
install proﬁling cookies before consent, and possibly install more after that.

5.4

Impact of device and location

We study Browser-DS dataset to check whether installed proﬁling cookies vary
when using diﬀerent browsers, devices, or changing country where the client is
located.

Fig. 5 reports the number of installed proﬁling cookies when using diﬀerent

9

Country Banner Banner and Refresh

France

Germany

Italy

69

31

53

2

0

14

Table 1: Number of websites showing the Cookie Bar, and refreshing the page
upon user consent.

Italy

France

Desktop

Germany
Mobile

 100

g
n

i
l
i
f
o
r
P

s
e
i
k
o
o
C

 10

 1

0

I

E

F

C

ir
e
f
o

x

h

r

o

A

n

d

r

i

P

a

d

2

A

n

d

r

i

P

h

o

m

e

o
i
d
-

T

a

User Agent

b

le
t

n

e

6

o
i
d
-

P

h

o

n

e

Figure 5: Number of proﬁling cookies set with diﬀerent browsers.

browsers and devices, separately for Italian, French and German websites. Box
plots span from the 1st to the 3rd quartile, while whiskers report the 10th and
the 90th percentiles; black strokes represent the median. A quite large amount of
proﬁling cookies is installed independently on the kind of browser or device, and
the number only slightly decreases for mobiles. This is likely due to the simpler
pages served to mobile devices. Recall that Germany has not yet transposed
the ePrivacy Directive at the moment of writing. This is reﬂected in the results
with German websites installing more proﬁling cookies than French and Italian,
respectively.

Finally, when the Country-DS websites are visited from 9 European countries
(France, Italy, Germany, Finland, Netherlands, Portugal, Spain and Sweden)
the number of proﬁling cookies does not change. Results are reported in Fig. 6
using boxplots, whose characteristics are the same as in the previous ﬁgure. We
conclude that websites do not adapt the set of proﬁling cookies to install if the
country of the visitor implements the Directive in a diﬀerent way.

6 Related Work

To the best of our knowledge, this is the ﬁrst technical work analyzing the
adoption of the ePrivacy Directive at scale. Only Leenes and Kosta addressed
the same problem [18]. They manually visited 100 Dutch websites and observed

10

g
n

i
l
i
f
o
r
P

s
e
i
k
o
o
C

 100

 10

 1

F

F

G

N

P

I

t

e

r

m

a
l
y

e

t

h

o

r

t

i
n
l
a

r

a

n

c

e

n

d

S

p

S

w

a
i
n

e

d

e

n

e
rl
a

u

g

a
l

n

d

s

a

n

y

Location

Figure 6: Number of proﬁling cookies set when changing crawling location. No
signiﬁcant diﬀerence is observed.

that most do not respect the ePrivacy Directive. Similar observations emerged
as a side eﬀect in one of our previous studies [15].

Related to this work, it worths mentioning the work from Englehardt et
al. [13]. They addressed the problem of characterizing online tracking on very
large number of websites. The dataset authors collect contains the same infor-
mation we build upon to understand if a website violates the ePrivacy Directive,
but they did not consider that the “ﬁrst visit” may be diﬀerent due to regula-
tions in place.

Some works studied the ePrivacy Directive from the legal perspective [17, 20].
All concluded that this is a case of regulatory failure. Koops [17] argues that the
Directive creates the illusion that individuals have control over their data, and
it is diﬃcult for webmasters to respect it. Diﬀerently, Markou [20] pinpoints
that the cause of the failure lies in resistance of advertisement ecosystem and
in the lack of privacy awareness among users. Here, we quantify the failure by
showing technical evidences rather than legal arguments.

7 Discussion and conclusion

Despite being conservative, our results clearly uncover that the majority of
websites ignores the ePrivacy Directive, testifying its ﬂop.

We identify 5 main reasons behind this:

i) the Directive does not oﬀer guidelines to perform systematic auditing pro-
cedures with a coordinated supervision. Two oﬃcial reports from independent
third parties [24, 12] conﬁrm this. In particular, [12] emphasizes that enforce-
ment of rules is “insuﬃcient and inconsistent ”, as currently in charge of each
member state’s competent authorities which “tend to audit in cases where there
is a speciﬁc risk or complaint by an individual. Ex-oﬃcio audits remain a mi-
nority.”
ii) The lack of automatic tools that can verify whether a website violates the
Directive makes it possibly complicated for the deputed agencies to plan sys-
tematic audits.

11

iii) The Directive does not delineate clear standardization procedures to uni-
form the composition of the Cookie Bar and the implementation of the cookie
consent acquisition. This lack complicates both being compliant with the Di-
rective as well as its enforcement.
Indeed,
iv) It is cumbersome for webmasters to fully support the Directive.
it is hard to control the activity of third parties, especially in the complicated
ecosystem of advertisement and tracking platforms. Small websites cannot likely
aﬀord the additional technical and monetary costs.
v) Despite users are becoming more and more conscious about their privacy be-
ing violated in the web, the overall consciousness level is still too low. Regulators
should complement the ePrivacy Directive with proper awareness campaigns
aiming at educating users about how their privacy is threaten under the surface
of the web. Regarding this, the Regulatory Fitness and Performance (REFIT),
the EU body in charge of verifying eﬀectiveness of Directives, states the current
rules end being counter-productive as “the constant stream of cookie pop-up-
boxes that users are faced with completely eclipses the general goal of privacy
protection as the result is that users blindly accept cookies” [22].

EU is currently drafting a revision of the Directive [9]. It aims to conﬁrm the
principles that govern the old one, but also to adapt them to new technologies
and scenarios. Unfortunately, it still neglects above issues.

We have introduced CookieCheck as a crude and simple tool to audit whether
a website violates the ePrivacy Directive. It is available online [1], along with
source code [2] and datasets collected for this study, so that it can be improved
to include further checks.

Considering the research and measurement community, we are among the
ﬁrst to face the veriﬁcation of privacy regulations. This is surprising, comparing
to the eﬀort given by the community to design tools to gauge, e.g., censorship
and violations of network neutrality. We hope the eﬀort in producing tools for
auditing privacy violations will increase and get momentum.

12

References

[1] CookieCheck online tool.
https://goo.gl/spfjOn.

[2] CookieChecker Code Repository.

https://hub.docker.com/r/martino90/automatic_browser/.

[3] Similarweb.

https://www.similarweb.com/.

[4] Webpagetest.

https://www.webpagetest.org/.

[5] Better Privacy Tool. Trackers on alexa top 500 news sites.

https://better.fyi/trackers/alexa-top-500-news/.

[6] Council of European Union. Directive 95/46/EC on the protection of
individuals with regard to the processing of personal data and on the free
movement of such data, 1995.
http://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:
31995L0046.

[7] Council of European Union.

Directive 2002/58/EC concerning the
processing of personal data and the protection of privacy in the electronic
communications sector (Directive on privacy and electronic communica-
tions), 2002.
http://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:
32002L0058.

[8] Council of European Union. Directive 2009/136/EC , 2009.

http://eur-lex.europa.eu/legal-content/en/TXT/?uri=CELEX:
32009L0136.

[9] Council of European Union. Proposal for a Regulation on Privacy and

Electronic Communications, 2017.
https://ec.europa.eu/digital-single-market/en/news/proposal-
regulation-privacy-and-electronic-communications.

[10] Data Protection Working Party. Opinion 15/2011 on the deﬁnition of

consent, 2011.
http://ec.europa.eu/justice/policies/privacy/docs/wpdocs/
2011/wp187_en.pdf.

[11] Data Protection Working Party. Opinion 04/2012 on cookie consent

exemption, 2012.
http://ec.europa.eu/justice/data-protection/article-29/
documentation/opinion-recommendation/files/2012/wp194_en.
pdf.

13

[12] Deloitte. Evaluation and review of Directive 2002/58 on privacy and the

electronic communication sector, 2016.
https://ec.europa.eu/digital-single-market/en/news/
evaluation-and-review-directive-200258-privacy-and-
electronic-communication-sector.

[13] Steven Englehardt and Arvind Narayanan. Online tracking: A 1-million-
site measurement and analysis. In Proceedings of the 2016 ACM SIGSAC
Conference on Computer and Communications Security, CCS ’16, pages
1388–1401, New York, NY, USA, 2016. ACM.

[14] Steven Englehardt, Dillon Reisman, Christian Eubank, Peter Zimmerman,
Jonathan Mayer, Arvind Narayanan, and Edward W. Felten. Cookies that
give you away: The surveillance implications of web tracking. In Proceed-
ings of the 24th International Conference on World Wide Web, WWW
’15, pages 289–299, Republic and Canton of Geneva, Switzerland, 2015.
International World Wide Web Conferences Steering Committee.

[15] Leonardo Giannantoni, Stefano Traverso, Hassan Metwalley, Martino Tre-
visan, and Marco Mellia. Benchmark and comparison of tracker-blockers:
Should you trust them? Proceedings of the TMA, 2017.

[16] CJ Hoofnagle, JM Urban, and S Li. Privacy and modern advertising. In

Proceedings of Amsterdam Privacy Conference, 2012.

[17] Bert-Jaap Koops. The trouble with european data protection law. Inter-

national Data Privacy Law, 4(4):250–261, 2014.

[18] Ronald Leenes and Eleni Kosta. Taming the cookie monster with dutch
law–a tale of regulatory failure. Computer Law & Security Review,
31(3):317–335, 2015.

[19] Miriam Marciel, Rub´en Cuevas, Albert Banchs, Roberto Gonz´alez, Stefano
Traverso, Mohamed Ahmed, and Arturo Azcorra. Understanding the de-
tection of view fraud in video content portals. In Proceedings of the 25th
International Conference on World Wide Web, WWW ’16, pages 357–368,
Republic and Canton of Geneva, Switzerland, 2016. International World
Wide Web Conferences Steering Committee.

[20] Christina Markou. Behavioural advertising and the new eu cookie lawas a
victim of business resistance and a lack of oﬃcial determination. In Data
Protection on the Move, pages 213–247. Springer, 2016.

[21] Pratical Law. Data protection global guide.

https://uk.practicallaw.thomsonreuters.com/Browse/Home/
International/DataProtectionGlobalGuide.

[22] REFIT Platform. REFIT Platform Opinion on the submission by the
Danish Business Forum on the E Privacy Directive and the current rules

14

related to ”cookies”, 2016.
http://ec.europa.eu/info/sites/info/files/opinion_comm_net.
pdf.

[23] Software is hard. Har 1.2 spec.

http://www.softwareishard.com/blog/har-12-spec.

[24] Time.lex and Spark.

ePrivacy Directive: assessment of transposition,
eﬀectiveness and compatibility with proposed Data Protection Regulation,
2013.
https://ec.europa.eu/digital-single-market/en/news/eprivacy-
directive-assessment-transposition-effectiveness-and-
compatibility-proposed-data.

[25] Joseph Turow, Jennifer King, Chris Jay Hoofnagle, Amy Bleakley, and
Michael Hennessy. Americans reject tailored advertising and three activities
that enable it. 2009. Available at SSRN 1478214.

15

