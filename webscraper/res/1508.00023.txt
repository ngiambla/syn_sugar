 V. j,s = aj,s Z+ and hence the feasibility condition (1) reduces uihi,s for all s [S], aj,s Z+, For a single category system (L = 1), note that z1 aj,srj,s (cid:88) (cid:88) to: j i (cid:80) with condition (2) additionally requiring aj,s = aj,s(cid:48) for all j, s, s(cid:48).
 Thus, C(u) is the set of {aj,s} satisfying the above conditions for respective classes of jobs and C( ) is the weighted (by (u)) sum of convex hulls of C(u)s, here C = C( ). (cid:80) has a simple characterization as well.
 As for any j [N ], (j, 1) E, and N (J) = 1 for all J [N ], Cout (cid:110) :(cid:80) i [M ] ihi,s.
 Thus it is suf cient to satisfy the inequality for J = [N ], and hence, l N (J) Cout i [M ] ihi = The MaxWeight computation in MWTA for single-category systems turns out to be the following integer linear i,s = (cid:80) j [N ] jrj (cid:80) i [M l] l (cid:111) ihl . program (ILP), which is related to knapsack problems. (5) (cid:88) j,srj,s (cid:88) j,s arg max { j,s:j,s} s.t. (cid:88) Qj,s j,s uihi,s s [S], j i j,s = j,s(cid:48), s, s(cid:48), j (only for ND) For decomposable and non-decomposable systems, this is a single knapsack and multi-dimensional knapsack problem [34], respectively, and hence NP-hard.
 There exist fully polynomial time approximations (FPTAS) for single knapsack, whereas for multi-dimensional knapsack only polynomial time approximations (PTAS) are possible 1  C }.
 With this approximation, say 1 , the MWTA policy stabilizes (1 ) C = { : that for large crowd systems each i is large and hence stabilizing any with + 1 C is almost optimal.
 Crowd system with jobs accepted and allocated according to (7) is stable and (cid:80) (cid:80)T Aj(t)] can be made arbitrarily small for an appropriately chosen , for all suf ciently large T .
 E[(cid:80) j j(1 ) 1 T j t=1 Proof: See Appendix II.L. (cid:80)T This theorem demonstrates that by following the job acceptance and allocation method (7), the crowd system can be stabilized while ensuring the average number of accepted jobs per allocation epoch is arbitrarily close to the optimal number of accepted jobs per allocation period.
 Hence for any  (0, 1), there exist such that for all < = mini,j,s( j,s, Note that since N, S, and M are nite and (26) (27) i,s > 0, for all i, j, s, > 0.
 Moreover, note that does not depend on , since the ratio of the linear and quadratic terms in the log moment generating functions are independent of and . k k! , for the Poisson-dominated case we have As e 1 =(cid:80) j,s, k=1 j,s, i,s, log Aj( rj,1,s) j rj,s(1 + ) log Ui( hi,s) i hi,s(1 ) log Aj( rj,s) j (cid:88) (cid:88) k ( rj,s)k k! ( hi,s)k Again, by the same argument, we can have a for which (26) and (27) are satis ed.
