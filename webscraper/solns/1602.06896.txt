principal component analysis (pca) is a widely used method for dimensionreduction. in high dimensional data, the "signal" eigenvalues corresponding toweak principal components (pcs) do not necessarily separate from the bulk ofthe "noise" eigenvalues. therefore, popular tests based on the largesteigenvalue have little power to detect weak pcs. in the special case of thespiked model, certain tests asymptotically equivalent to linear spectralstatistics (lss)---averaging effects over all eigenvalues---were recently shownto achieve some power.  we consider a nonparametric, non-gaussian generalization of the spiked modelto the setting of marchenko and pastur (1967). this allows a general bulk ofthe noise eigenvalues, accomodating correlated variables even under the nullhypothesis of no significant pcs.  we develop new tests based on lss to detect weak pcs in this model. we showusing the clt for lss that the optimal lss satisfy a fredholm integral equationof the first kind. we develop algorithms to solve it, building on our recentmethod for computing the limit empirical spectrum. in contrast to the standardspiked model, we find that under "widely spread" null eigenvalue distributions,the new tests have a lot of power.