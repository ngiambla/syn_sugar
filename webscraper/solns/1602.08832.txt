the first author's geometric hopf invariant of a stable map$f:\sigma^{\infty}x \to \sigma^{\infty}y$ is a stable ${\mathbbz}_2$-equivariant map $h(f):\sigma^{\infty}x \to \sigma^{\infty}(y \wedge y)$constructed by an explicit difference construction applied to $(f \wedgef)\delta_x - \delta_y f$. the stable ${\mathbb z}_2$-equivariant homotopy classof $h(f)$ is the primary obstruction to desuspending $f$ up to homotopy. theexplicit nature of the construction allows for a $\pi$-equivariant version of$h(f)$ in the case of a $\pi$-equivariant $f$, with $\pi$ a discrete group. inearlier joint work we applied the $\pi_1(n)$-equivariant geometric hopfinvariant of the umkehr map $f:\sigma^{\infty}n^+ \to \sigma^{\infty}t(\nu_f)$of an immersion $f:m \to n$ to capture the double points of $f$ in ${\mathbbz}_2$-equivariant homotopy theory. in this manuscript we use the$\pi$-equivariant geometric hopf invariant $h(f)$ to unify all the previoushomotopy theoretic treatments of double points. furthermore, $h(f)$ is combinedwith the second author's algebraic surgery theory of chain complexes withpoincar\'e duality to provide the homotopy theoretic foundations fornon-simply-connected geometric surgery. for an $n$-dimensional normal map$(f,b):m \to x$ the $\pi_1(x)$-equivariant geometric hopf invariant $h(f)$ ofthe umkehr map $f:\sigma^{\infty}x^+ \to\sigma^{\infty}m^+$ is shown to inducethe $\pi_1(x)$-equivariant quadratic structure $\psi_f$ on the chain complexkernel $c$ of $(f,b)$. previously $\psi_f$ had only been constructed using thechain complex analogue of the functional steenrod squares. the wall surgeryobstruction $\sigma_*(f,b)=(c,\psi_f) \in l_n({\mathbb z}[\pi_1(x)])$ is thecobordism class of the corresponding $n$-dimensional quadratic poincar\'ecomplex $(c,\psi_f)$, as in the original theory.