in recent years, a number of methods have been developed to infer complexdemographic histories, especially historical population size changes, fromgenomic sequence data. coalescent hidden markov models have proven to beparticularly useful for this type of inference. due to the markovian structureof these models, an essential building block is the joint distribution of localgenealogical trees, or statistics of these genealogies, at two neighboring lociin populations of variable size. here, we present a novel method to compute themarginal and the joint distribution of the total length of the genealogicaltrees at two loci separated by at most one recombination event for samples ofarbitrary size. to our knowledge, no method to compute these distributions hasbeen presented in the literature to date. we show that they can be obtainedfrom the solution of certain hyperbolic systems of partial differentialequations. we present a numerical algorithm, based on the method ofcharacteristics, that can be used to efficiently and accurately solve thesesystems and compute the marginal and the joint distributions. we demonstrateits utility to study the properties of the joint distribution. our flexiblemethod can be straightforwardly extended to handle an arbitrary fixed number ofrecombination events, to include the distributions of other statistics of thegenealogies as well, and can also be applied in structured populations.