let g be a group, and let m=(m_n) be a sequence of finitely supportedprobability measures on g. consider the probability that two elements chosenindependently according to m_n commute. antolin, martino and ventura define the'degree of commutativity' dc_m(g) of g with respect to this sequence to be thelim sup of this probability. the main results of the present paper givequantitative algebraic consequences of the degree of commutativity being abovecertain thresholds. for example, if m_n is the distribution of the nth step ofa symmetric random walk on g, or if g is amenable and (m_n) is a sequence ofalmost-invariant measures on g, we show that if dc_m(g)>5/8 then g is abelian;if it is at least 1/2+c then the centre of g has index at most 1/c; and if itis at least a>0 then g contains a normal subgroup g' of index o_a(1) and anormal subgroup h of cardinality at most o_a(1) such that g'/h is abelian. wealso describe some general conditions on (m_n) under which such theorems hold.these results generalise results for finite groups due to gustafson and p. m.neumann, and generalise and quantify a result for certain residually finitegroups of subexponential growth due to antolin, martino and ventura. we alsopresent an application to conjugacy ratios, showing that if the sequence ofword-metric balls in a finitely generated group is both left- and right-folnerthen the conjugacy ratio is equal to the degree of commutativity. combined withour main results, this generalises a result of ciobanu, cox and martino.